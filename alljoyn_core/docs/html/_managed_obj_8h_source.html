<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>AllJoyn C++ API Reference Manual: ManagedObj.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">AllJoyn C++ API Reference Manual
   &#160;<span id="projectnumber">Version 3.4.5</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">ManagedObj.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_managed_obj_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00008"></a>00008 <span class="comment">/******************************************************************************</span>
<a name="l00009"></a>00009 <span class="comment"> * Copyright (c) 2009-2012, AllSeen Alliance. All rights reserved.</span>
<a name="l00010"></a>00010 <span class="comment"> *</span>
<a name="l00011"></a>00011 <span class="comment"> *    Permission to use, copy, modify, and/or distribute this software for any</span>
<a name="l00012"></a>00012 <span class="comment"> *    purpose with or without fee is hereby granted, provided that the above</span>
<a name="l00013"></a>00013 <span class="comment"> *    copyright notice and this permission notice appear in all copies.</span>
<a name="l00014"></a>00014 <span class="comment"> *</span>
<a name="l00015"></a>00015 <span class="comment"> *    THE SOFTWARE IS PROVIDED &quot;AS IS&quot; AND THE AUTHOR DISCLAIMS ALL WARRANTIES</span>
<a name="l00016"></a>00016 <span class="comment"> *    WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF</span>
<a name="l00017"></a>00017 <span class="comment"> *    MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR</span>
<a name="l00018"></a>00018 <span class="comment"> *    ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES</span>
<a name="l00019"></a>00019 <span class="comment"> *    WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN</span>
<a name="l00020"></a>00020 <span class="comment"> *    ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF</span>
<a name="l00021"></a>00021 <span class="comment"> *    OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.</span>
<a name="l00022"></a>00022 <span class="comment"> ******************************************************************************/</span>
<a name="l00023"></a>00023 <span class="preprocessor">#ifndef _QCC_MANAGEDOBJ_H</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span><span class="preprocessor">#define _QCC_MANAGEDOBJ_H</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span>
<a name="l00026"></a>00026 <span class="preprocessor">#include &lt;<a class="code" href="platform_8h.html" title="This file just wraps including actual OS and toolchain specific header files depding on the OS group ...">qcc/platform.h</a>&gt;</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#if defined(QCC_OS_ANDROID)</span>
<a name="l00029"></a>00029 <span class="preprocessor"></span><span class="comment">// This must be included before #include &lt;new&gt; for building on Froyo with</span>
<a name="l00030"></a>00030 <span class="comment">// certain versions of STLPort.</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#endif</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span>
<a name="l00034"></a>00034 <span class="preprocessor">#include &lt;new&gt;</span>
<a name="l00035"></a>00035 
<a name="l00036"></a>00036 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include &lt;assert.h&gt;</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="preprocessor">#include &lt;<a class="code" href="atomic_8h.html" title="Toolchain specific wrapper for atomic.h.">qcc/atomic.h</a>&gt;</span>
<a name="l00040"></a>00040 
<a name="l00041"></a>00041 <span class="keyword">namespace </span>qcc {
<a name="l00042"></a>00042 
<a name="l00043"></a>00043 
<a name="l00052"></a>00052 <span class="keyword">template</span> &lt;<span class="keyword">class</span> T&gt;
<a name="l00053"></a><a class="code" href="classqcc_1_1_managed_obj.html">00053</a> <span class="keyword">class </span><a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj</a> {
<a name="l00054"></a>00054   <span class="keyword">private</span>:
<a name="l00055"></a>00055 
<a name="l00056"></a>00056     <span class="keyword">static</span> <span class="keyword">const</span> uint32_t ManagedCtxMagic = ((<span class="charliteral">&#39;M&#39;</span>) | (<span class="charliteral">&#39;C&#39;</span> &lt;&lt; 8) | ((<span class="charliteral">&#39;T&#39;</span> &lt;&lt; 16)  + (<span class="charliteral">&#39;X&#39;</span> &lt;&lt; 24)));
<a name="l00057"></a>00057 
<a name="l00058"></a>00058     <span class="keyword">struct </span>ManagedCtx {
<a name="l00059"></a>00059         ManagedCtx(int32_t refCount) : refCount(refCount), magic(ManagedCtxMagic) { }
<a name="l00060"></a>00060         int32_t refCount;
<a name="l00061"></a>00061         uint32_t magic;
<a name="l00062"></a>00062     };
<a name="l00063"></a>00063 
<a name="l00064"></a>00064     ManagedCtx* context;
<a name="l00065"></a>00065     T* object;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067   <span class="keyword">public</span>:
<a name="l00068"></a>00068 
<a name="l00070"></a><a class="code" href="classqcc_1_1_managed_obj.html#a63bb3fa9803b3d3600104e6f09d63591">00070</a>     <span class="keyword">typedef</span> T <a class="code" href="classqcc_1_1_managed_obj.html#a63bb3fa9803b3d3600104e6f09d63591" title="The underlying type that is being managed.">ManagedType</a>;
<a name="l00071"></a>00071 
<a name="l00073"></a><a class="code" href="classqcc_1_1_managed_obj.html#accdd335f4c08650e6e0f62b1f59d2bcf">00073</a>     <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(<span class="keyword">const</span> <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>&amp;copyMe)
<a name="l00074"></a>00074     {
<a name="l00075"></a>00075         context = copyMe.context;
<a name="l00076"></a>00076         <span class="keywordtype">object</span> = copyMe.object;
<a name="l00077"></a>00077         <a class="code" href="classqcc_1_1_managed_obj.html#a84e9aa3e537b1d925b63b4e070d3258e" title="Increment the ref count.">IncRef</a>();
<a name="l00078"></a>00078     }
<a name="l00079"></a>00079 
<a name="l00081"></a><a class="code" href="classqcc_1_1_managed_obj.html#a0e33e9e037de45543408010872f76ee5">00081</a>     <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(<a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>&amp;copyMe)
<a name="l00082"></a>00082     {
<a name="l00083"></a>00083         context = copyMe.context;
<a name="l00084"></a>00084         <span class="keywordtype">object</span> = copyMe.object;
<a name="l00085"></a>00085         <a class="code" href="classqcc_1_1_managed_obj.html#a84e9aa3e537b1d925b63b4e070d3258e" title="Increment the ref count.">IncRef</a>();
<a name="l00086"></a>00086     }
<a name="l00087"></a>00087 
<a name="l00103"></a><a class="code" href="classqcc_1_1_managed_obj.html#ae06ac504106f602ac887a3c3c39c026a">00103</a>     <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(<span class="keyword">const</span> <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>&amp;other, <span class="keywordtype">bool</span> isDeep)
<a name="l00104"></a>00104     {
<a name="l00105"></a>00105         <span class="keywordflow">if</span> (isDeep) {
<a name="l00106"></a>00106             <span class="comment">/* Deep copy */</span>
<a name="l00107"></a>00107             <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00108"></a>00108             context = <span class="keyword">reinterpret_cast&lt;</span>ManagedCtx*<span class="keyword">&gt;</span>(malloc(offset + <span class="keyword">sizeof</span>(T)));
<a name="l00109"></a>00109             context = <span class="keyword">new</span> (context) ManagedCtx(1);
<a name="l00110"></a>00110             <span class="keywordtype">object</span> = <span class="keyword">new</span> ((<span class="keywordtype">char</span>*)context + offset)T(*other);
<a name="l00111"></a>00111         } <span class="keywordflow">else</span> {
<a name="l00112"></a>00112             <span class="comment">/* Normal copy constructor (inc ref) of existing object */</span>
<a name="l00113"></a>00113             context = other.context;
<a name="l00114"></a>00114             <span class="keywordtype">object</span> = other.object;
<a name="l00115"></a>00115             <a class="code" href="classqcc_1_1_managed_obj.html#a84e9aa3e537b1d925b63b4e070d3258e" title="Increment the ref count.">IncRef</a>();
<a name="l00116"></a>00116         }
<a name="l00117"></a>00117     }
<a name="l00118"></a>00118 
<a name="l00120"></a><a class="code" href="classqcc_1_1_managed_obj.html#a7e36a30ba55466ded24ca7be5b0356cd">00120</a>     <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>()
<a name="l00121"></a>00121     {
<a name="l00122"></a>00122         <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00123"></a>00123         context = <span class="keyword">reinterpret_cast&lt;</span>ManagedCtx*<span class="keyword">&gt;</span>(malloc(offset + <span class="keyword">sizeof</span>(T)));
<a name="l00124"></a>00124         context = <span class="keyword">new</span> (context) ManagedCtx(1);
<a name="l00125"></a>00125         <span class="keywordtype">object</span> = <span class="keyword">new</span> ((<span class="keywordtype">char</span>*)context + offset)T();
<a name="l00126"></a>00126     }
<a name="l00127"></a>00127 
<a name="l00136"></a><a class="code" href="classqcc_1_1_managed_obj.html#aaa9080e65ccc2c2e8ce872361fd2adcf">00136</a>     <span class="keyword">static</span> <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a> <a class="code" href="classqcc_1_1_managed_obj.html#aaa9080e65ccc2c2e8ce872361fd2adcf" title="Static method to wrap an existing T that is already managed in its managed object type...">wrap</a>(T* naked)
<a name="l00137"></a>00137     {
<a name="l00138"></a>00138         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00139"></a>00139         <span class="keywordflow">return</span> <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>((ManagedCtx*)((<span class="keywordtype">char</span>*)naked - offset), naked);
<a name="l00140"></a>00140     }
<a name="l00141"></a>00141 
<a name="l00148"></a><a class="code" href="classqcc_1_1_managed_obj.html#abb6054642f998cfe9b4e6cfa3d4ef6da">00148</a>     <span class="keyword">template</span> &lt;<span class="keyword">class</span> T2&gt; <span class="keyword">static</span> <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a> <a class="code" href="classqcc_1_1_managed_obj.html#abb6054642f998cfe9b4e6cfa3d4ef6da" title="Static method to convert between managed objects of related types.">cast</a>(T2&amp; other)
<a name="l00149"></a>00149     {
<a name="l00150"></a>00150         <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00151"></a>00151         <span class="keywordflow">return</span> <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>((ManagedCtx*)((<span class="keywordtype">char</span>*)other.unwrap() - offset), static_cast&lt;T*&gt;(other.unwrap()));
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153 
<a name="l00158"></a><a class="code" href="classqcc_1_1_managed_obj.html#a10af5237b870b64ad1d7426aacc9e1ee">00158</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> A1&gt; <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(A1 &amp; arg1)
<a name="l00159"></a>00159     {
<a name="l00160"></a>00160         <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00161"></a>00161         context = <span class="keyword">reinterpret_cast&lt;</span>ManagedCtx*<span class="keyword">&gt;</span>(malloc(offset + <span class="keyword">sizeof</span>(T)));
<a name="l00162"></a>00162         context = <span class="keyword">new</span> (context) ManagedCtx(1);
<a name="l00163"></a>00163         <span class="keywordtype">object</span> = <span class="keyword">new</span> ((<span class="keywordtype">char</span>*)context + offset)T(arg1);
<a name="l00164"></a>00164     }
<a name="l00165"></a>00165 
<a name="l00171"></a><a class="code" href="classqcc_1_1_managed_obj.html#a91e7bb4b078b1f065fae78dece8373be">00171</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> A1, <span class="keyword">typename</span> A2&gt; <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(A1 &amp; arg1, A2 &amp; arg2)
<a name="l00172"></a>00172     {
<a name="l00173"></a>00173         <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00174"></a>00174         context = <span class="keyword">reinterpret_cast&lt;</span>ManagedCtx*<span class="keyword">&gt;</span>(malloc(offset + <span class="keyword">sizeof</span>(T)));
<a name="l00175"></a>00175         context = <span class="keyword">new</span> (context) ManagedCtx(1);
<a name="l00176"></a>00176         <span class="keywordtype">object</span> = <span class="keyword">new</span> ((<span class="keywordtype">char</span>*)context + offset)T(arg1, arg2);
<a name="l00177"></a>00177     }
<a name="l00178"></a>00178 
<a name="l00185"></a><a class="code" href="classqcc_1_1_managed_obj.html#ae99cb9ec4554c1eddc5a35d6716e7102">00185</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> A1, <span class="keyword">typename</span> A2, <span class="keyword">typename</span> A3&gt; <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(A1 &amp; arg1, A2 &amp; arg2, A3 &amp; arg3)
<a name="l00186"></a>00186     {
<a name="l00187"></a>00187         <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00188"></a>00188         context = <span class="keyword">reinterpret_cast&lt;</span>ManagedCtx*<span class="keyword">&gt;</span>(malloc(offset + <span class="keyword">sizeof</span>(T)));
<a name="l00189"></a>00189         context = <span class="keyword">new</span> (context) ManagedCtx(1);
<a name="l00190"></a>00190         <span class="keywordtype">object</span> = <span class="keyword">new</span> ((<span class="keywordtype">char</span>*)context + offset)T(arg1, arg2, arg3);
<a name="l00191"></a>00191     }
<a name="l00192"></a>00192 
<a name="l00200"></a><a class="code" href="classqcc_1_1_managed_obj.html#a199ea3ba913f55df2425c35ef2c281c5">00200</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> A1, <span class="keyword">typename</span> A2, <span class="keyword">typename</span> A3, <span class="keyword">typename</span> A4&gt; <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(A1 &amp; arg1, A2 &amp; arg2, A3 &amp; arg3, A4 &amp; arg4)
<a name="l00201"></a>00201     {
<a name="l00202"></a>00202         <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00203"></a>00203         context = <span class="keyword">reinterpret_cast&lt;</span>ManagedCtx*<span class="keyword">&gt;</span>(malloc(offset + <span class="keyword">sizeof</span>(T)));
<a name="l00204"></a>00204         context = <span class="keyword">new</span> (context) ManagedCtx(1);
<a name="l00205"></a>00205         <span class="keywordtype">object</span> = <span class="keyword">new</span> ((<span class="keywordtype">char</span>*)context + offset)T(arg1, arg2, arg3, arg4);
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207 
<a name="l00216"></a><a class="code" href="classqcc_1_1_managed_obj.html#ae1c6a8a2297060acea3218a24aab7775">00216</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> A1, <span class="keyword">typename</span> A2, <span class="keyword">typename</span> A3, <span class="keyword">typename</span> A4, <span class="keyword">typename</span> A5&gt; <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(A1 &amp; arg1, A2 &amp; arg2, A3 &amp; arg3, A4 &amp; arg4, A5 &amp; arg5)
<a name="l00217"></a>00217     {
<a name="l00218"></a>00218         <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00219"></a>00219         context = <span class="keyword">reinterpret_cast&lt;</span>ManagedCtx*<span class="keyword">&gt;</span>(malloc(offset + <span class="keyword">sizeof</span>(T)));
<a name="l00220"></a>00220         context = <span class="keyword">new</span> (context) ManagedCtx(1);
<a name="l00221"></a>00221         <span class="keywordtype">object</span> = <span class="keyword">new</span> ((<span class="keywordtype">char</span>*)context + offset)T(arg1, arg2, arg3, arg4, arg5);
<a name="l00222"></a>00222     }
<a name="l00223"></a>00223 
<a name="l00233"></a><a class="code" href="classqcc_1_1_managed_obj.html#ae63e3bed57e510f61019f7a0f933ecfd">00233</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> A1, <span class="keyword">typename</span> A2, <span class="keyword">typename</span> A3, <span class="keyword">typename</span> A4, <span class="keyword">typename</span> A5, <span class="keyword">typename</span> A6&gt; <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(A1 &amp; arg1, A2 &amp; arg2, A3 &amp; arg3, A4 &amp; arg4, A5 &amp; arg5, A6 &amp; arg6)
<a name="l00234"></a>00234     {
<a name="l00235"></a>00235         <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00236"></a>00236         context = <span class="keyword">reinterpret_cast&lt;</span>ManagedCtx*<span class="keyword">&gt;</span>(malloc(offset + <span class="keyword">sizeof</span>(T)));
<a name="l00237"></a>00237         context = <span class="keyword">new</span> (context) ManagedCtx(1);
<a name="l00238"></a>00238         <span class="keywordtype">object</span> = <span class="keyword">new</span> ((<span class="keywordtype">char</span>*)context + offset)T(arg1, arg2, arg3, arg4, arg5, arg6);
<a name="l00239"></a>00239     }
<a name="l00240"></a>00240 
<a name="l00251"></a><a class="code" href="classqcc_1_1_managed_obj.html#a10e9539518ed641f47f4630064d7a1e9">00251</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> A1, <span class="keyword">typename</span> A2, <span class="keyword">typename</span> A3, <span class="keyword">typename</span> A4, <span class="keyword">typename</span> A5, <span class="keyword">typename</span> A6, <span class="keyword">typename</span> A7&gt; <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(A1 &amp; arg1, A2 &amp; arg2, A3 &amp; arg3, A4 &amp; arg4, A5 &amp; arg5, A6 &amp; arg6, A7 &amp; arg7)
<a name="l00252"></a>00252     {
<a name="l00253"></a>00253         <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00254"></a>00254         context = <span class="keyword">reinterpret_cast&lt;</span>ManagedCtx*<span class="keyword">&gt;</span>(malloc(offset + <span class="keyword">sizeof</span>(T)));
<a name="l00255"></a>00255         context = <span class="keyword">new</span> (context) ManagedCtx(1);
<a name="l00256"></a>00256         <span class="keywordtype">object</span> = <span class="keyword">new</span> ((<span class="keywordtype">char</span>*)context + offset)T(arg1, arg2, arg3, arg4, arg5, arg6, arg7);
<a name="l00257"></a>00257     }
<a name="l00258"></a>00258 
<a name="l00270"></a><a class="code" href="classqcc_1_1_managed_obj.html#ad8ef619070eb183606604f449818f625">00270</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> A1, <span class="keyword">typename</span> A2, <span class="keyword">typename</span> A3, <span class="keyword">typename</span> A4, <span class="keyword">typename</span> A5, <span class="keyword">typename</span> A6, <span class="keyword">typename</span> A7, <span class="keyword">typename</span> A8&gt; <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(A1 &amp; arg1, A2 &amp; arg2, A3 &amp; arg3, A4 &amp; arg4, A5 &amp; arg5, A6 &amp; arg6, A7 &amp; arg7, A8 &amp; arg8)
<a name="l00271"></a>00271     {
<a name="l00272"></a>00272         <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00273"></a>00273         context = <span class="keyword">reinterpret_cast&lt;</span>ManagedCtx*<span class="keyword">&gt;</span>(malloc(offset + <span class="keyword">sizeof</span>(T)));
<a name="l00274"></a>00274         context = <span class="keyword">new</span> (context) ManagedCtx(1);
<a name="l00275"></a>00275         <span class="keywordtype">object</span> = <span class="keyword">new</span> ((<span class="keywordtype">char</span>*)context + offset)T(arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8);
<a name="l00276"></a>00276     }
<a name="l00277"></a>00277 
<a name="l00290"></a><a class="code" href="classqcc_1_1_managed_obj.html#a12966af6bbc180c35a731239c61e605f">00290</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> A1, <span class="keyword">typename</span> A2, <span class="keyword">typename</span> A3, <span class="keyword">typename</span> A4, <span class="keyword">typename</span> A5, <span class="keyword">typename</span> A6, <span class="keyword">typename</span> A7, <span class="keyword">typename</span> A8, <span class="keyword">typename</span> A9&gt; <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(A1 &amp; arg1, A2 &amp; arg2, A3 &amp; arg3, A4 &amp; arg4, A5 &amp; arg5, A6 &amp; arg6, A7 &amp; arg7, A8 &amp; arg8, A9 &amp; arg9)
<a name="l00291"></a>00291     {
<a name="l00292"></a>00292         <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00293"></a>00293         context = <span class="keyword">reinterpret_cast&lt;</span>ManagedCtx*<span class="keyword">&gt;</span>(malloc(offset + <span class="keyword">sizeof</span>(T)));
<a name="l00294"></a>00294         context = <span class="keyword">new</span> (context) ManagedCtx(1);
<a name="l00295"></a>00295         <span class="keywordtype">object</span> = <span class="keyword">new</span> ((<span class="keywordtype">char</span>*)context + offset)T(arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9);
<a name="l00296"></a>00296     }
<a name="l00297"></a>00297 
<a name="l00311"></a><a class="code" href="classqcc_1_1_managed_obj.html#a08368c073e1314759ab972c0a05d7142">00311</a>     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> A1, <span class="keyword">typename</span> A2, <span class="keyword">typename</span> A3, <span class="keyword">typename</span> A4, <span class="keyword">typename</span> A5, <span class="keyword">typename</span> A6, <span class="keyword">typename</span> A7, <span class="keyword">typename</span> A8, <span class="keyword">typename</span> A9, <span class="keyword">typename</span> A10&gt; <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(A1 &amp; arg1, A2 &amp; arg2, A3 &amp; arg3, A4 &amp; arg4, A5 &amp; arg5, A6 &amp; arg6, A7 &amp; arg7, A8 &amp; arg8, A9 &amp; arg9, A10 &amp; arg10)
<a name="l00312"></a>00312     {
<a name="l00313"></a>00313         <span class="keyword">const</span> <span class="keywordtype">size_t</span> offset = (<span class="keyword">sizeof</span>(ManagedCtx) + 7) &amp; ~0x07;
<a name="l00314"></a>00314         context = <span class="keyword">reinterpret_cast&lt;</span>ManagedCtx*<span class="keyword">&gt;</span>(malloc(offset + <span class="keyword">sizeof</span>(T)));
<a name="l00315"></a>00315         context = <span class="keyword">new</span> (context) ManagedCtx(1);
<a name="l00316"></a>00316         <span class="keywordtype">object</span> = <span class="keyword">new</span> ((<span class="keywordtype">char</span>*)context + offset)T(arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10);
<a name="l00317"></a>00317     }
<a name="l00318"></a>00318 
<a name="l00323"></a><a class="code" href="classqcc_1_1_managed_obj.html#ae1be8d2271b91f8acd3b40763fcaabb5">00323</a>     ~<a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>()
<a name="l00324"></a>00324     {
<a name="l00325"></a>00325         <a class="code" href="classqcc_1_1_managed_obj.html#af5d015e7da6607c523366670a4866aac" title="Decrement the ref count and deallocate if necessary.">DecRef</a>();
<a name="l00326"></a>00326     }
<a name="l00327"></a>00327 
<a name="l00333"></a><a class="code" href="classqcc_1_1_managed_obj.html#a98ba159c9bb2b27b8b927d27a7a246a4">00333</a>     <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>&amp; <a class="code" href="classqcc_1_1_managed_obj.html#a98ba159c9bb2b27b8b927d27a7a246a4" title="Assign a ManagedObj&lt;T&gt; to an existing ManagedObj&lt;T&gt;">operator=</a>(<span class="keyword">const</span> <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>&amp; assignFromMe)
<a name="l00334"></a>00334     {
<a name="l00335"></a>00335         <span class="comment">/* Decrement ref of current context */</span>
<a name="l00336"></a>00336         <a class="code" href="classqcc_1_1_managed_obj.html#af5d015e7da6607c523366670a4866aac" title="Decrement the ref count and deallocate if necessary.">DecRef</a>();
<a name="l00337"></a>00337 
<a name="l00338"></a>00338         <span class="comment">/* Reassign this Managed Obj */</span>
<a name="l00339"></a>00339         context = assignFromMe.context;
<a name="l00340"></a>00340         <span class="keywordtype">object</span> = assignFromMe.object;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342         <span class="comment">/* Increment the ref */</span>
<a name="l00343"></a>00343         <a class="code" href="classqcc_1_1_managed_obj.html#a84e9aa3e537b1d925b63b4e070d3258e" title="Increment the ref count.">IncRef</a>();
<a name="l00344"></a>00344 
<a name="l00345"></a>00345         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00346"></a>00346     }
<a name="l00347"></a>00347 
<a name="l00353"></a><a class="code" href="classqcc_1_1_managed_obj.html#a2829f46ac359b15a0e317c058e80dee3">00353</a>     <span class="keywordtype">bool</span> <a class="code" href="classqcc_1_1_managed_obj.html#a2829f46ac359b15a0e317c058e80dee3" title="Equality for managed objects is whatever equality means for &lt;T&gt;">operator==</a>(<span class="keyword">const</span> <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>&amp; other)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> (<span class="keywordtype">object</span> == other.object) || (*<span class="keywordtype">object</span> == *other.object); }
<a name="l00354"></a>00354 
<a name="l00362"></a><a class="code" href="classqcc_1_1_managed_obj.html#ade2a31d3e67bf5cea99fd011342a8430">00362</a>     <span class="keyword">template</span> &lt;<span class="keyword">class</span> T2&gt; <span class="keywordtype">bool</span> <a class="code" href="classqcc_1_1_managed_obj.html#ade2a31d3e67bf5cea99fd011342a8430" title="Returns true if the two managed objects managed the same object.">iden</a>(<span class="keyword">const</span> <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T2&gt;</a>&amp; other)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> ((ptrdiff_t)<span class="keywordtype">object</span> == (ptrdiff_t)other.<a class="code" href="classqcc_1_1_managed_obj.html#a653fb1005bc57da72e85b6766fa5e4d6" title="Get a pointer to the managed object T.">unwrap</a>()); }
<a name="l00363"></a>00363 
<a name="l00369"></a><a class="code" href="classqcc_1_1_managed_obj.html#a6b8bf49727d9b3518cc63eefa4ccb7ab">00369</a>     <span class="keywordtype">bool</span> <a class="code" href="classqcc_1_1_managed_obj.html#a6b8bf49727d9b3518cc63eefa4ccb7ab" title="Inequality for managed objects is whatever inequality means for &lt;T&gt;">operator!=</a>(<span class="keyword">const</span> <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>&amp; other)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> !(*<span class="keyword">this</span> == other); }
<a name="l00370"></a>00370 
<a name="l00376"></a><a class="code" href="classqcc_1_1_managed_obj.html#ad663cbc72c0e0f1aa1c3932846ba7d04">00376</a>     <span class="keywordtype">bool</span> operator&lt;(const ManagedObj&lt;T&gt;&amp; other) <span class="keyword">const</span> { <span class="keywordflow">return</span> (<span class="keywordtype">object</span> != other.object) &amp;&amp; (*<span class="keywordtype">object</span> &lt; *other.object); }
<a name="l00377"></a>00377 
<a name="l00382"></a><a class="code" href="classqcc_1_1_managed_obj.html#a1b6494e2b9a2bb0f90731e66ef3fef91">00382</a>     T&amp; <a class="code" href="classqcc_1_1_managed_obj.html#a1b6494e2b9a2bb0f90731e66ef3fef91" title="Get a reference to T.">operator*</a>() { <span class="keywordflow">return</span> *object; }
<a name="l00383"></a>00383 
<a name="l00387"></a><a class="code" href="classqcc_1_1_managed_obj.html#a653fb1005bc57da72e85b6766fa5e4d6">00387</a>     T* <a class="code" href="classqcc_1_1_managed_obj.html#a653fb1005bc57da72e85b6766fa5e4d6" title="Get a pointer to the managed object T.">unwrap</a>() { <span class="keywordflow">return</span> object; }
<a name="l00388"></a>00388 
<a name="l00392"></a><a class="code" href="classqcc_1_1_managed_obj.html#acd9d7892c1fe69dcc8f66b68070b6757">00392</a>     <span class="keyword">const</span> T* <a class="code" href="classqcc_1_1_managed_obj.html#acd9d7892c1fe69dcc8f66b68070b6757" title="Get a pointer to the managed object T.">unwrap</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> object; }
<a name="l00393"></a>00393 
<a name="l00398"></a><a class="code" href="classqcc_1_1_managed_obj.html#a3c8205d20ee7cf7f410b0fa56a110b20">00398</a>     T* <a class="code" href="classqcc_1_1_managed_obj.html#a3c8205d20ee7cf7f410b0fa56a110b20" title="Get a pointer to T using the dereference operator.">operator-&gt;</a>() { <span class="keywordflow">return</span> object; }
<a name="l00399"></a>00399 
<a name="l00404"></a><a class="code" href="classqcc_1_1_managed_obj.html#af386f38e2c5fcfbfd3e3dbf68a4ef19b">00404</a>     <span class="keyword">const</span> T&amp; <a class="code" href="classqcc_1_1_managed_obj.html#af386f38e2c5fcfbfd3e3dbf68a4ef19b" title="Get a const reference to T.">operator*</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> *object; }
<a name="l00405"></a>00405 
<a name="l00410"></a><a class="code" href="classqcc_1_1_managed_obj.html#aeaf4b49bd2a8c71408644e1b6f16c2ce">00410</a>     <span class="keyword">const</span> T* <a class="code" href="classqcc_1_1_managed_obj.html#aeaf4b49bd2a8c71408644e1b6f16c2ce" title="Get a const pointer to T.">operator-&gt;</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> object; }
<a name="l00411"></a>00411 
<a name="l00413"></a><a class="code" href="classqcc_1_1_managed_obj.html#a84e9aa3e537b1d925b63b4e070d3258e">00413</a>     <span class="keywordtype">void</span> <a class="code" href="classqcc_1_1_managed_obj.html#a84e9aa3e537b1d925b63b4e070d3258e" title="Increment the ref count.">IncRef</a>()
<a name="l00414"></a>00414     {
<a name="l00415"></a>00415         IncrementAndFetch(&amp;context-&gt;refCount);
<a name="l00416"></a>00416     }
<a name="l00417"></a>00417 
<a name="l00419"></a><a class="code" href="classqcc_1_1_managed_obj.html#af5d015e7da6607c523366670a4866aac">00419</a>     <span class="keywordtype">void</span> <a class="code" href="classqcc_1_1_managed_obj.html#af5d015e7da6607c523366670a4866aac" title="Decrement the ref count and deallocate if necessary.">DecRef</a>()
<a name="l00420"></a>00420     {
<a name="l00421"></a>00421         uint32_t refs = DecrementAndFetch(&amp;context-&gt;refCount);
<a name="l00422"></a>00422         <span class="keywordflow">if</span> (0 == refs) {
<a name="l00423"></a>00423             <span class="comment">/* Call the overriden destructor */</span>
<a name="l00424"></a>00424             <span class="keywordtype">object</span>-&gt;~T();
<a name="l00425"></a>00425             context-&gt;ManagedCtx::~ManagedCtx();
<a name="l00426"></a>00426             free(context);
<a name="l00427"></a>00427             context = NULL;
<a name="l00428"></a>00428         }
<a name="l00429"></a>00429     }
<a name="l00430"></a>00430 
<a name="l00434"></a><a class="code" href="classqcc_1_1_managed_obj.html#a47f62cf080db5790445f645c2b68aece">00434</a>     int32_t <a class="code" href="classqcc_1_1_managed_obj.html#a47f62cf080db5790445f645c2b68aece" title="Get the reference count.">GetRefCount</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> context ? context-&gt;refCount : 0; }
<a name="l00435"></a>00435 
<a name="l00436"></a>00436   <span class="keyword">private</span>:
<a name="l00437"></a>00437 
<a name="l00438"></a>00438     <a class="code" href="classqcc_1_1_managed_obj.html" title="ManagedObj manages heap allocation and reference counting for a template parameter type T...">ManagedObj&lt;T&gt;</a>(ManagedCtx * context, T * object) : context(context), object(<span class="keywordtype">object</span>)
<a name="l00439"></a>00439     {
<a name="l00440"></a>00440         assert(context-&gt;magic == ManagedCtxMagic);
<a name="l00441"></a>00441         <a class="code" href="classqcc_1_1_managed_obj.html#a84e9aa3e537b1d925b63b4e070d3258e" title="Increment the ref count.">IncRef</a>();
<a name="l00442"></a>00442     }
<a name="l00443"></a>00443 };
<a name="l00444"></a>00444 
<a name="l00445"></a>00445 
<a name="l00446"></a>00446 }
<a name="l00447"></a>00447 
<a name="l00448"></a>00448 <span class="preprocessor">#endif</span>
</pre></div></div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<!--
Copyright (c) 2009-2013, AllSeen Alliance. All rights reserved.

   Permission to use, copy, modify, and/or distribute this software for any
   purpose with or without fee is hereby granted, provided that the above
   copyright notice and this permission notice appear in all copies.

   THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
   WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
   MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
   ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
   WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
   ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
   OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

-->
<!--oinaf1-->
<hr>
<small>

AllJoyn C++ API Reference Manual Version 3.4.5 (Fri Dec 6 2013 18:47:02)<br/>
Copyright &copy; 2009-2013 AllSeen Alliance.<br/>
<b>THIS DOCUMENT AND ALL INFORMATION CONTAIN HEREIN ARE PROVIDED ON AN "AS-IS" BASIS WITHOUT WARRANTY OF ANY KIND</b>.<br/>
<b>MAY CONTAIN U.S. AND INTERNATIONAL EXPORT CONTROLLED INFORMATION</b><br/>

</small>
</body>
</html>
<!--oinaf2-->
